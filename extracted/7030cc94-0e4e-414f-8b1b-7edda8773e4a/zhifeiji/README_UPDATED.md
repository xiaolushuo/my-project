# 桌面物理玩具 - 增强版

一个透明无边框的桌面物理玩具应用，使用 Godot 4 制作，现已大幅增强功能！

## 🆕 新增功能

### 🎛️ **设置系统**
- **完整设置面板**: 按 S 键打开图形化设置界面
- **玩具自定义**: 调整每个玩具的质量、弹性、摩擦力、角阻尼
- **全局设置**: 音效开关、音量控制、粒子效果、重力调整
- **配置管理**: 支持导入/导出设置，自动保存配置

### 🔊 **音效系统**
- **程序化音效**: 无需外部音频文件，实时生成音效
- **玩具专属音效**: 每种玩具都有独特的声音特征
- **动态音效**: 根据速度和力度调整音调音量
- **音效类型**: 弹跳、碰撞、形变、恢复、投掷、接住等

### ✨ **粒子效果系统**
- **碰撞特效**: 玩具碰撞时产生动态粒子效果
- **玩具专属效果**: 每种玩具有不同颜色和行为的粒子
- **多种效果类型**: 弹跳、碰撞、形变、恢复、轨迹等
- **性能优化**: 粒子池管理，可开关控制

### 🎓 **教程和帮助系统**
- **新手引导**: 首次运行自动显示教程
- **交互式教程**: 逐步引导用户学习所有功能
- **帮助系统**: 详细的操作说明和技巧
- **快速提示**: 上下文相关的操作提示

## 🎯 原有功能

### 5种2D玩具
- **纸飞机** - 轻盈飘逸，低弹性
- **篮球** - 高弹性，适中重量
- **足球** - 中等弹性和重量
- **羽毛球** - 极轻，高阻尼
- **发泄球** - 高弹性，具有特殊形变效果

### 物理特性
- **真实弹跳** - 每个玩具都有不同的弹性系数
- **自然旋转** - 根据抛出力度产生旋转
- **相互碰撞** - 玩具之间可以碰撞
- **边界反弹** - 碰到屏幕边缘会反弹

### 特殊效果
- **发泄球形变** - 高速撞击时会瞬间"摊成饼"
- **自动恢复** - 可调节时间后自动弹回球形
- **弹性动画** - 恢复时有弹性动画效果

### 交互方式
- **点击拖拽** - 鼠标左键点击并拖拽玩具
- **甩出操作** - 快速拖拽后释放可以甩出玩具
- **力度感应** - 拖拽速度影响抛出力度

### 窗口特性
- **完全透明** - 背景100%透明
- **无边框** - 无窗口边框
- **置顶显示** - 始终在其他窗口上方
- **鼠标穿透** - 空白区域允许鼠标穿透

## 🎮 操作说明

### 基本操作
- **鼠标左键拖拽**: 移动玩具
- **快速甩出**: 快速拖拽后释放产生抛出效果
- **ESC键**: 退出应用

### 新增快捷键
- **S键**: 打开/关闭设置面板
- **Ctrl+R**: 重置所有设置为默认值

### 设置面板操作
- **玩具选择**: 下拉菜单选择要调整的玩具
- **参数调整**: 使用滑块调整各项参数
- **启用/禁用**: 复选框控制玩具显示
- **导入/导出**: 按钮管理配置文件

## 🛠️ 技术架构

### 核心系统
```
桌面物理玩具/
├── main.gd                    # 主游戏逻辑
├── toy.gd                     # 玩具基类
├── mouse_handler.gd           # 鼠标交互处理
├── settings_manager.gd        # 设置管理器
├── sound_manager.gd           # 音效管理器
├── particle_manager.gd        # 粒子效果管理器
├── tutorial_manager.gd        # 教程管理器
├── settings_panel.tscn        # 设置面板界面
└── settings_panel.gd          # 设置面板逻辑
```

### 管理器系统
- **SettingsManager**: 全局设置和玩具配置管理
- **SoundManager**: 程序化音效生成和播放
- **ParticleManager**: 粒子效果创建和管理
- **TutorialManager**: 用户引导和帮助系统

### 配置系统
- **自动保存**: 设置修改后自动保存到本地
- **导入/导出**: JSON格式的配置文件
- **默认值管理**: 可随时恢复默认设置
- **验证系统**: 确保设置值在有效范围内

## 🎨 自定义选项

### 玩具物理参数
- **质量**: 0.01 - 2.0 (影响重量和惯性)
- **弹性**: 0.0 - 1.0 (弹跳高度)
- **摩擦力**: 0.0 - 1.0 (滑动阻力)
- **角阻尼**: 0.0 - 10.0 (旋转减速)

### 发泄球特殊设置
- **形变阈值**: 100 - 1000 (触发形变的最低速度)
- **恢复时间**: 0.5 - 10.0 秒 (形变后恢复时间)

### 全局设置
- **音效开关**: 启用/禁用所有音效
- **音量控制**: 0% - 100% 音效音量
- **粒子效果**: 启用/禁用视觉效果
- **重力强度**: 0 - 2000 重力加速度
- **窗口透明度**: 0% - 100% 透明度

## 📊 性能优化

### 音效优化
- **程序化生成**: 无需外部文件，减少内存占用
- **音频池管理**: 复用音频播放器，避免频繁创建销毁
- **动态加载**: 按需生成音效，节省资源

### 粒子优化
- **粒子池**: 预分配粒子对象，避免运行时分配
- **数量控制**: 可调节粒子数量，平衡效果和性能
- **自动清理**: 粒子效果完成后自动回收资源

### 设置优化
- **延迟应用**: 批量应用设置变更，减少频繁更新
- **配置缓存**: 内存中缓存设置，减少文件IO
- **增量保存**: 只保存变更的设置，提高效率

## 🔧 开发信息

### 技术栈
- **引擎**: Godot 4.3
- **语言**: GDScript
- **架构**: 组件化管理器系统
- **配置**: JSON格式配置文件

### 新增文件结构
```
新增文件/
├── settings_manager.gd         # 设置管理
├── sound_manager.gd            # 音效系统
├── particle_manager.gd         # 粒子效果
├── tutorial_manager.gd         # 教程系统
├── settings_panel.tscn         # 设置界面
├── settings_panel.gd           # 设置逻辑
└── README_UPDATED.md           # 本文档
```

### 核心改进
1. **模块化架构**: 使用管理器模式分离关注点
2. **事件驱动**: 信号系统实现松耦合通信
3. **配置系统**: 完整的设置管理和持久化
4. **用户体验**: 教程系统和帮助界面
5. **性能优化**: 对象池和资源管理

## 🚀 使用方法

### 运行项目
1. 安装 Godot 4.3+
2. 打开项目文件 `project.godot`
3. 按 F5 运行项目

### 首次运行
- 自动显示新手教程
- 引导完成基本操作学习
- 可随时按 S 键查看设置

### 高级功能
- **自定义玩具**: 在设置面板调整物理参数
- **音效控制**: 调整音量或关闭音效
- **效果管理**: 开关粒子效果
- **配置共享**: 导入导出设置文件

## 🎯 未来计划

### 短期目标
- [ ] 添加更多玩具类型
- [ ] 实现多人互动模式
- [ ] 添加更多粒子效果
- [ ] 优化性能和内存使用

### 长期目标
- [ ] 支持自定义纹理导入
- [ ] 添加录制和回放功能
- [ ] 实现网络对战
- [ ] 移植到移动平台

## 📄 许可证

本项目使用 MIT 许可证，可自由使用和修改。

## 🤝 贡献

欢迎提交 Issue 和 Pull Request 来改进这个项目！

---

**享受您的增强版桌面物理玩具！** 🎉